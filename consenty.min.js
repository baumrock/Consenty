var consenty;(()=>{class e{elements={};allow(e){this.save(e,!0)}getStorage(){let e,t=localStorage.getItem("consenty")||"{}";try{return e=JSON.parse(t),"object"!=typeof e?{}:e||{}}catch(e){return{}}}handleChange(e){const t=e.target;if("checkbox"===t.type&&t.hasAttribute("consenty-toggle")){const e=t.getAttribute("consenty-toggle");t.checked?this.allow(e):this.revoke(e)}}handleClick(e){let t;if(t=e.target.closest("[consenty-allow]")){const e=t.getAttribute("consenty-allow");this.allow(e)}else if(t=e.target.closest("[consenty-revoke]")){const e=t.getAttribute("consenty-revoke");this.revoke(e)}}hasConsent(e){let t=this.getStorage();return!(!t||!(e in t))&&!!t[e]}hideElement(e){const t=this.elements[e];t.new&&(t.new.remove(),t.new=!1,this.elements[e]=t)}init(){this.reload(),document.dispatchEvent(new CustomEvent("consenty:init"))}initCheckboxes(){document.querySelectorAll("[consenty-toggle]").forEach((e=>{e.checked=this.hasConsent(e.getAttribute("consenty-toggle"))}))}reload(){this.toggleIFs(),this.initCheckboxes()}revoke(e){this.save(e,!1)}save(e,t){let n=this.getStorage();const s=this.hasConsent(e);t?(n[e]=1,document.dispatchEvent(new CustomEvent("consenty:allow",{detail:e}))):(delete n[e],document.dispatchEvent(new CustomEvent("consenty:revoke",{detail:e}))),this.saveStorage(n),document.dispatchEvent(new CustomEvent("consenty:change",{detail:{name:e,from:s,to:this.hasConsent(e)}})),this.toggleIFs()}saveStorage(e){localStorage.setItem("consenty",JSON.stringify(e))}toggleIFs(){document.querySelectorAll("[consenty-if]").forEach((e=>{let t;e.hasAttribute("data-consenty-id")?t=e.getAttribute("data-consenty-id"):(t=Object.keys(this.elements).length+1,this.elements[t]={old:e,new:!1},e.setAttribute("data-consenty-id",t));const n=e.getAttribute("consenty-if"),s=n.startsWith("!")?"hideif":"showif";let o="showif"===s?n:n.substring(1);"showif"===s?this.hasConsent(o)?this.showElement(t):this.hideElement(t):this.hasConsent(o)?this.hideElement(t):this.showElement(t)}))}showElement(e){const t=this.elements[e];if(!t.new){if("template"===t.old.tagName.toLowerCase()){let n=document.createElement("div"),s=t.old;s.parentNode.insertBefore(n,s.nextSibling),n.appendChild(document.importNode(s.content,!0)),t.new=n,this.elements[e]=t,this.reload()}}}}document.addEventListener("DOMContentLoaded",(function(){(consenty=new e).init(),document.addEventListener("click",consenty.handleClick.bind(consenty)),document.addEventListener("change",consenty.handleChange.bind(consenty))}))})();